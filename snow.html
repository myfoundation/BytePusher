<!DOCTYPE html>
<head>
<meta charset="utf-8">
<title>Snow Demo</title>
</head>
<body>
<canvas id="screen"></canvas>
<script>
let colors = [
0x000000, 0x330000, 0x660000, 0x990000,
0xcc0000, 0xff0000, 0x003300, 0x333300,
0x663300, 0x993300, 0xcc3300, 0xff3300,
0x006600, 0x336600, 0x666600, 0x996600,
0xcc6600, 0xff6600, 0x009900, 0x339900,
0x669900, 0x999900, 0xcc9900, 0xff9900,
0x00cc00, 0x33cc00, 0x66cc00, 0x99cc00,
0xcccc00, 0xffcc00, 0x00ff00, 0x33ff00,
0x66ff00, 0x99ff00, 0xccff00, 0xffff00,
0x000033, 0x330033, 0x660033, 0x990033,
0xcc0033, 0xff0033, 0x003333, 0x333333,
0x663333, 0x993333, 0xcc3333, 0xff3333,
0x006633, 0x336633, 0x666633, 0x996633,
0xcc6633, 0xff6633, 0x009933, 0x339933,
0x669933, 0x999933, 0xcc9933, 0xff9933,
0x00cc33, 0x33cc33, 0x66cc33, 0x99cc33,
0xcccc33, 0xffcc33, 0x00ff33, 0x33ff33,
0x66ff33, 0x99ff33, 0xccff33, 0xffff33,
0x000066, 0x330066, 0x660066, 0x990066,
0xcc0066, 0xff0066, 0x003366, 0x333366,
0x663366, 0x993366, 0xcc3366, 0xff3366,
0x006666, 0x336666, 0x666666, 0x996666,
0xcc6666, 0xff6666, 0x009966, 0x339966,
0x669966, 0x999966, 0xcc9966, 0xff9966,
0x00cc66, 0x33cc66, 0x66cc66, 0x99cc66,
0xcccc66, 0xffcc66, 0x00ff66, 0x33ff66,
0x66ff66, 0x99ff66, 0xccff66, 0xffff66,
0x000099, 0x330099, 0x660099, 0x990099,
0xcc0099, 0xff0099, 0x003399, 0x333399,
0x663399, 0x993399, 0xcc3399, 0xff3399,
0x006699, 0x336699, 0x666699, 0x996699,
0xcc6699, 0xff6699, 0x009999, 0x339999,
0x669999, 0x999999, 0xcc9999, 0xff9999,
0x00cc99, 0x33cc99, 0x66cc99, 0x99cc99,
0xcccc99, 0xffcc99, 0x00ff99, 0x33ff99,
0x66ff99, 0x99ff99, 0xccff99, 0xffff99,
0x0000cc, 0x3300cc, 0x6600cc, 0x9900cc,
0xcc00cc, 0xff00cc, 0x0033cc, 0x3333cc,
0x6633cc, 0x9933cc, 0xcc33cc, 0xff33cc,
0x0066cc, 0x3366cc, 0x6666cc, 0x9966cc,
0xcc66cc, 0xff66cc, 0x0099cc, 0x3399cc,
0x6699cc, 0x9999cc, 0xcc99cc, 0xff99cc,
0x00cccc, 0x33cccc, 0x66cccc, 0x99cccc,
0xcccccc, 0xffcccc, 0x00ffcc, 0x33ffcc,
0x66ffcc, 0x99ffcc, 0xccffcc, 0xffffcc,
0x0000ff, 0x3300ff, 0x6600ff, 0x9900ff,
0xcc00ff, 0xff00ff, 0x0033ff, 0x3333ff,
0x6633ff, 0x9933ff, 0xcc33ff, 0xff33ff,
0x0066ff, 0x3366ff, 0x6666ff, 0x9966ff,
0xcc66ff, 0xff66ff, 0x0099ff, 0x3399ff,
0x6699ff, 0x9999ff, 0xcc99ff, 0xff99ff,
0x00ccff, 0x33ccff, 0x66ccff, 0x99ccff,
0xccccff, 0xffccff, 0x00ffff, 0x33ffff,
0x66ffff, 0x99ffff, 0xccffff, 0xffffff,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000,
0x000000, 0x000000, 0x000000, 0x000000
];

let mem = new Uint8Array(1 << 24);

let prog = atob('AAAAAAgDAAAACAAAJgIAABEACCMAKAAAABoACGsAKAEAACMAJgIAADkAACwAJgIAADoAADUACAEBAAAAAD4AJgIAAEkAAEcACgAAJgIAAFAAJgIAAFsAAFkACQAAAGQAAGIAKAAAAGoAACMACAAAAAMAAHQACH0AAAQAAHQACAAAKAAAAIYACNgAKAEAAI8ACBsAKQAAAJgACKsAKQEAAKEACA4AJgYAAKoACAwAJgIAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAmAgABCwABCQALAAAmAgABEgAIAAAmAwABGwAmBgABLgABJAAmAwABLwABLQAOAAAnAAABNgAmAwABQQABPwAKAAAmAwABSAAmBgABWwABUQAmAwABXAABWgAOAAAmAAABYwAmAwABbgABbAAKAAAmAwABdQAmAAABiwABfgAnAAABjAABhwAIWQMAAAABkAAmAwABmwABmQAJAAABpAABogApAAABqgABGwAmBgABtgABtAAKAAAmBgABvQAmAgAByAABxgAJAAAB0QABzwAoAAAB1wABAAAIBQAoAAAB4QAI3QAoAQAB6gAIIAApAAAB8wAIsAApAQAB/AAIDAAmAgACBQAmAgACEAACDgALAAAmAgACFwAIAAAmAwACIAAmBgACMwACKQAmAwACNAACMgAOAAAnAAACOwAmAwACRgACRAAKAAAmAwACTQAmBgACYAACVgAmAwACYQACXwAOAAAmAAACaAAmAwACcwACcQAKAAAmAwACegAmAAACkAACgwAnAAACkQACjAAIZQMAAAAClQAmAwACoAACngAJAAACqQACpwApAAACrwACIAAmBgACuwACuQAKAAAmBgACwgAmAgACzQACywAJAAAC1gAC1AAoAAAC3AACBQAIYwAoAAAC5gAIogAoAQAC7wAIPwApAAAC+AAIAAApAQADAQAIAAAqAAADCgAIWgAqAQADEwAIzwArAAADHAAI4QArAQADJQAIAwAAAwADLgAINwAABAADLgAmAwADQgADQAAMAAAmAAADSQAmAAADVAADUgAsAAAmBQADWwAmBQADZgADZAAJAAADbwADbQAqAAADdQAEAAAAAAAAAAAAAAAAAAAA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PGtka2VrZmtna2hraWtqa5NrlGuVa5Zrl2uYa5lrmmsybDNsNGw1bDZsN2w4bDlsOmw7bDxsPWw+bGFsYmxjbGRsZWxmbGdsaGxpbGpsa2xsbG1skGyRbJJsk2yUbJVslmyXbJhsmWyabJtsnGydbLxsvWy+bL9swGzBbMJsw2zEbMVsxmzHbMhsyWzKbMtszGzNbM5sz2wwbTFtMm0zbTRtNW02bTdtOG05bTptO208bT1tPm0/bUBtYG1hbWJtY21kbWVtZm1nbWhtaW1qbWttbG1tbW5tj22QbZFtkm2TbZRtlW2WbZdtmG2ZbZptm22cbZ1tnm28bb1tvm2/bcBtwW3CbcNtxG3FbcZtx23Ibcltym3LbcxtzW3Obc9tL24wbjFuMm4zbjRuNW42bjpuO248bj1uPm4/bkBuQW5fbmBuYW5ibmNuZG5lbmZuaG5pbmpua25sbm1ubm5vbo5uj26QbpFukm6TbpRumG6Zbppum26cbp1unm6fbrxuvW6+br9uwG7BbsJuw27EbsVuxm7HbshuyW7KbstuzG7Nbs5uz24vbzBvMW8ybzNvPG89bz5vP29Ab0FvXm9fb2BvYW9ib2Nva29sb21vbm9vb3BvjW+Ob49vkG+Rb5Jvm2+cb51vnm+fb6BvvG+9b75vv28ucC9wMHAxcDJwPXA+cD9wQHBBcEJwXnBfcGBwYXBicGxwbXBucG9wcHCMcI1wjnCPcJBwkXCccJ1wnnCfcKBwvHC9cL5wv3AtcS5xL3EwcTFxMnE+cT9xQHFBcUJxXXFecV9xYHFhcW1xbnFvcXBxcXGMcY1xjnGPcZBxnHGdcZ5xn3GgcaFxvHG9cb5xv3Etci5yL3IwcjFyPnI/ckByQXJCckNyXXJecl9yYHJhcm1ybnJvcnBycXKMco1yjnKPcpBynXKecp9yoHKhcrxyvXK+cr9yLXMucy9zMHMxcz9zQHNBc0JzQ3Ndc15zX3Ngc2FzbXNuc29zcHNxc4tzjHONc45zj3Odc55zn3Ogc6FzvHO9c75zv3MtdC50L3QwdDF0P3RAdEF0QnRDdFx0XXRedF90YHRudG90cHRxdHJ0i3SMdI10jnSPdJ10nnSfdKB0oXS8dL10vnQ/dUB1QXVCdUN1XHVddV51X3VgdW51b3VwdXF1cnWddZ51n3WgdaF1vHW9db51P3ZAdkF2QnZDdlx2XXZedl92YHZudm92cHZxdnJ2nXaedp92oHahdrx2vXa+dj53P3dAd0F3QndDd1x3XXded193YHdud293cHdxd3J3nXeed593oHehd7x3vXe+dz54P3hAeEF4QnhceF14XnhfeGB4bnhveHB4cXhyeJ14nnifeKB4oXi7eLx4vXi+eD55P3lAeUF5QnlbeVx5XXleeV95YHlueW95cHlxeXJ5nHmdeZ55n3mgeaF5u3m8eb15vnk9ej56P3pAekF6Qnpbelx6XXpeel96YHpuem96cHpxenJ6c3qcep16nnqfeqB6u3q8er16vnrEesV6xnrHesh6yXrKejx7PXs+ez97QHtBe1t7XHtde157X3tue297cHtxe3J7c3ube5x7nXuee597oHu7e7x7vXu+e8J7w3vEe8V7xnvHe8h7yXvKe8t7zHs8fD18Pnw/fEB8W3xcfF18XnxffG98cHxxfHJ8c3yafJt8nHydfJ58n3y7fLx8vXy+fL98wXzCfMN8xHzFfMZ8x3zIfMl8ynzLfMx8zXw7fTx9PX0+fT99QH1bfVx9XX1efV99b31wfXF9cn1zfZl9mn2bfZx9nX2efbt9vH29fb59v33AfcF9wn3Dfch9yX3Kfct9zH3Nfc59On47fjx+PX4+fj9+W35cfl1+Xn5ffm9+cH5xfnJ+c36Yfpl+mn6bfpx+nX67frx+vX6+fr9+wH7Bfsp+y37Mfs1+zn7Pfjl/On87fzx/PX8+f1t/XH9df15/X39vf3B/cX9yf3N/l3+Yf5l/mn+bf5x/u3+8f71/vn+/f8B/y3/Mf81/zn/Pf9B/OIA5gDqAO4A8gD2AW4BcgF2AXoBfgG+AcIBxgHKAc4CWgJeAmICZgJqAm4C7gLyAvYC+gL+AzIDNgM6Az4DQgDeBOIE5gTqBO4E8gVuBXIFdgV6BX4FvgXCBcYFygXOBlYGWgZeBmIGZgZqBvYG+gcyBzYHOgc+B0IE2gjeCOII5gjqCO4JbglyCXYJegl+Cb4JwgnGCcoJzgpSClYKWgpeCmIKZgsyCzYLOgs+C0ILRgjWDNoM3gziDOYM6g1uDXINdg16DX4Nug2+DcINxg3KDc4OTg5SDlYOWg5eDmIPNg86Dz4PQg9GDNIQ1hDaEN4Q4hDmEW4RchF2EXoRfhGCEboRvhHCEcYRyhHOEkoSThJSElYSWhJeEzYTOhM+E0ITRhDOFNIU1hTaFN4U4hVyFXYVehV+FYIVuhW+FcIVxhXKFkoWThZSFlYWWhc2FzoXPhdCF0YUyhjOGNIY1hjaGN4Zchl2GXoZfhmCGboZvhnCGcYZyhpGGkoaThpSGlYbNhs6Gz4bQhtGGMYcyhzOHNIc1hzaHXIddh16HX4dgh26Hb4dwh3GHcoeQh5GHkoeTh5SHzYfOh8+H0IfRhzCIMYgyiDOINIg1iFyIXYheiF+IYIhuiG+IcIhxiHKIj4iQiJGIkoiTiM2IzojPiNCI0YgwiTGJMokziTSJXIldiV6JX4lgiW6Jb4lwiXGJcomOiY+JkImRiZKJzYnOic+J0InRiS+KMIoxijKKM4pcil2KXopfimCKbopvinCKcYpyio6Kj4qQipGKzYrOis+K0IrRii6LL4swizGLMotdi16LX4tgi2GLbYtui2+LcItxi42LjouPi5CLkYvMi82LzovPi9CLLowvjDCMMYxdjF6MX4xgjGGMbYxujG+McIxxjIyMjYyOjI+MkIy6jLuMvIy9jL6MzIzNjM6Mz4zQjC2NLo0vjTCNMY1djV6NX41gjWGNbY1ujW+NcI2MjY2Njo2PjbqNu428jb2Nvo2/jcuNzI3Njc6Nz43QjS2OLo4vjjCOXo5fjmCOYY5ijmyObY5ujm+OcI6LjoyOjY6Ojo+Ou468jr2Ovo6/jsqOy47Mjs2Ozo7PjiyPLY8ujy+PMI9ej1+PYI9hj2KPY49rj2yPbY9uj2+Pi4+Mj42Pjo+7j7yPvY++j7+PwI/Bj8mPyo/Lj8yPzY/OjyyQLZAukC+QMJAxkDKQM5A0kDWQNpA3kDiQOZA6kDuQPJA9kD6QP5BAkEGQQpBDkF+QYJBhkGKQY5BkkGWQZpBokGmQapBrkGyQbZBukG+Qi5CMkI2QjpCPkJCQkZCSkJOQlJCVkJaQl5CYkJmQmpCbkJyQnZCekJ+QoJChkKKQvJC9kL6Qv5DAkMGQwpDDkMeQyJDJkMqQy5DMkM2QLJEtkS6RL5EwkTGRMpEzkTSRNZE2kTeROJE5kTqRO5E8kT2RPpE/kUCRQZFCkUORYJFhkWKRY5FkkWWRZpFnkWiRaZFqkWuRbJFtkW6Ri5GMkY2RjpGPkZCRkZGSkZORlJGVkZaRl5GYkZmRmpGbkZyRnZGekZ+RoJGhkaKRvZG+kb+RwJHBkcKRw5HEkcWRxpHHkciRyZHKkcuRzJEski2SLpIvkjCSMZIykjOSNJI1kjaSN5I4kjmSOpI7kjySPZI+kj+SQJJBkkKSQ5JhkmKSY5JkkmWSZpJnkmiSaZJqkmuSbJKLkoySjZKOko+SkJKRkpKSk5KUkpWSlpKXkpiSmZKakpuSnJKdkp6Sn5KgkqGSopK/ksCSwZLCksOSxJLFksaSx5LIksmSypLLkmOTZJNlk2aTZ5Nok2mTapPBk8KTw5PEk8WTxpPHk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJPIk8iTyJM0aTVpNmk3aThpOWk6aTtpPGlkaWVpZmlnaWhpaWlqaZNplGmVaZZpl2mYaZlpmmkyajNqNGo1ajZqN2o4ajlqOmo7ajxqPWo+amFqYmpjamRqZWpmamdqaGppampqa2psam1qkGqRapJqk2qUapVqlmqXaphqmWqaaptqnGqdarpqu2q8ar1qvmq/asBqwWrCasNqxGrFasZqx2rIaslqymrLasxqzWrOas9q0GrRajBrMWsyazNrPWs+az9rQGtga2FrYmtja2trbGtta25rjmuPa5BrkWuSa5trnGuda55rn2u6a7trvGu9a75rv2vAa8FrwmvDa8RrxWvGa8dryGvJa8pry2vMa81rzmvPa9Br0WsvbDBsMWw/bEBsQWxebF9sYGxubG9scGyNbI5sj2yebJ9soGy6bLts0GzRbC5tL21BbUJtXm1fbW9tcG2MbY1tjm2fbaBtoW26bbtt0G3RbS1uLm43bjhuOW5CbkNuXW5ebmducG5xboxujW6VbpZul26gbqFuom66brtu0G7RbixvLW8ubzRvNW82bzdvOG85bzpvO29Cb0NvRG9cb11vZG9lb2ZvZ29ob2lvam9xb3Jvi2+Mb5NvlG+Vb5Zvl2+Yb5lvmm+hb6Jvum+7b8BvwW/Cb8NvxG/Fb8Zvx2/Ib8lvym/Lb8xvzW/Ob89v0G/RbyxwLXAzcDRwNXA2cDpwO3A8cENwRHBccF1wY3BkcGVwaXBqcGtwcXBycIpwi3CScJNwlHCYcJlwmnCbcKFwonCjcLpwu3DAcMFwwnDDcMRwxXDGcMdwyHDJcMpwy3DMcM1wznDPcNBw0XArcSxxM3E0cTtxPHE9cUNxRHFbcVxxYnFjcWRxanFrcWxxcnFzcYpxi3GRcZJxk3GacZtxonGjcbpxu3HAccFxK3IscjJyM3I8cj1yRHJFcltyXHJicmNya3JscnJyc3KKcotykXKScptynHKicqNyunK7csBywXIrcyxzMnMzcz1zPnNEc0VzW3Ncc2JzY3Nrc2xzcnNzc4lzinOQc5Fzm3Occ6Jzo3O6c7tzwHMrdCx0MnQzdD10PnREdEV0WnRbdGF0YnRsdG10c3R0dIl0inSQdJF0m3ScdKJ0o3S6dLt0v3TAdCp1K3UsdS11LnUvdTB1MXUydT11PnVEdUV1WnVbdWF1YnVsdW11c3V0dYl1inWLdYx1jXWOdY91kHWRdZt1nHWidaN1unW7db91wHUsdi12LnYvdjB2MXYydj12PnZEdkV2WnZbdmF2YnZsdm12c3Z0dop2i3aMdo12jnaPdpB2kXabdpx2onajdrp2u3a/dsB2MXcydzx3PXdEd0V3Wndbd2F3Yndsd213c3d0d493kHeRd5t3nHeid6N3une7d793wHc8eD14Q3hEeFp4W3hheGJ4bHhteHN4dHibeJx4onijeLp4v3jAeMR4xXjGeMd4yHjJeMp4O3k8eT15Q3lEeVp5YXlieWx5bXlzeXR5mnmbeaJ5o3m6eb95wHnBecJ5w3nEecV5xnnHech5yXnKect5zHk7ejx6Q3pEell6Wnphem16dHp1epl6mnqbeqF6onq5erp6v3rAesF6wnrDest6zHrNes56Ons7e0J7Q3tZe1p7YHthe217dHt1e5l7mnuhe6J7uXu6e797wHvBe817znvPezl8Onw7fEF8QnxDfFl8WnxgfGF8bXxufHR8dXyYfJl8oHyhfLl8unzAfM58z3zQfDh9OX06fUF9Qn1ZfVp9YH1hfW19bn10fXV9l32YfZ99oH2hfbl9un3EfcV9xn3Hfc990H3RfTd+OH45fkB+QX5Zflp+YH5hfm1+bn50fnV+ln6Xfp5+n36gfrl+un7CfsN+xH7FfsZ+x37Ifsl+0H7RfjZ/N384fz9/QH9Zf1p/YH9hf21/bn90f3V/lX+Wf51/nn+ff7l/un/Bf8J/w3/If8l/yn/Rf9J/NYA2gDeAPoA/gFmAWoBggGGAbYBugHSAdYCUgJWAnICdgJ6AuYC6gMCAwYDJgMqAy4DRgNKANIE1gTaBPYE+gVmBWoFggWGBbYFugXSBdYGTgZSBm4GcgZ2BuYG6gbuBvIG/gcCBwYHKgcuB0YHSgTOCNII1gjyCPYJZglqCYIJhgm2CboJ0gnWCkoKTgpqCm4KcgrmCuoK7gryCvYK+gr+CwILKgsuC0oLTgjKDM4M0gzuDPINZg1qDYINhg22DdIN1g5GDkoOZg5qDm4O+g7+DwIPLg8yD0oPTgzGEMoQzhDqEO4RZhFqEYYRshG2EdISQhJGEmISZhJqEy4TMhNKE04QwhTGFMoU5hTqFWoVbhWGFYoVshW2Fc4V0hY+FkIWRhZeFmIWZhcuFzIXShdOFMIYxhjiGOYZahluGYYZihmyGbYZzhnSGjoaPhpCGloaXhpiGy4bMhtKG04YvhzCHN4c4h1qHW4dhh2KHbIdth3OHdIeNh46Hj4eVh5aHl4fLh8yH0ofThy6IL4g2iDeIWohbiGGIYohsiG2Ic4h0iI2IjoiUiJWIlojLiMyI0ojTiC2JLokviTWJNolaiVuJYYliiWyJbYlziXSJjImNiZOJlImVib6Jv4nLicyJ0onTiS2KLoo0ijWKWopbimGKYopsim2Kc4p0iouKjIqNipKKk4qUirqKu4q8ir2Kvoq/isCKyorLisyK0orTiiyLLYszizSLNYtbi1yLYotji2uLbItyi3OLi4uMi5KLk4u4i7mLuou7i7yLvYu+i7+LwIvKi8uL0YvSiyuMLIwtjDKMM4w0jFuMXIxijGOMa4xsjHKMc4yKjIuMkYySjLiMuYy/jMCMyozLjNGM0owrjSyNMo0zjVuNXI1ijWONZI1qjWuNbI1xjXKNc42KjYuNkI2RjZKNuI25jcCNwY3JjcqN0Y3SjSqOK44sjjGOMo4zjjSONY42jjeOOI45jjqOO448jj2OPo4/jkCOQY5CjkOORI5FjlyOXY5jjmSOZY5pjmqOa45xjnKOiY6KjpCOkY6SjpOOlI6VjpaOl46YjpmOmo6bjpyOnY6ejp+OoI6hjqKOo46kjrmOuo7AjsGOwo7DjseOyI7JjtCO0Y4qjyuPMY8yjzOPNI81jzaPN484jzmPOo87jzyPPY8+jz+PQI9Bj0KPQ49Ej0WPXI9dj2SPZY9mj2ePaI9pj2qPcI9xj3KPiY+Kj4+PkI+Rj5KPk4+Uj5WPlo+Xj5iPmY+aj5uPnI+dj56Pn4+gj6GPoo+jj6SPuY+6j8KPw4/Ej8WPxo/Hj8iPz4/Qj9GPKpArkESQRZBdkF6QZ5BwkHGQiZCKkKOQpJC6kLuQxJDFkMaQzpDPkNCQKpErkUSRRZFdkV6RX5FvkXCRiZGKkaORpJG6kbuRvJHNkc6Rz5EqkiuSRJJFkl6SX5Jgkm2SbpJvkomSipKjkqSSu5K8kr2SvpLMks2SzpIqkyuTLJMtky6TL5MwkzGTMpMzkzSTNZM2kzeTOJM5kzqTO5M8kz2TPpM/k0CTQZNCk0OTRJNFk1+TYJNhk2KTa5Nsk22TbpOJk4qTi5OMk42TjpOPk5CTkZOSk5OTlJOVk5aTl5OYk5mTmpObk5yTnZOek5+ToJOhk6KTo5Okk72TvpO/k8CTyZPKk8uTzJPNkyqUK5QslC2ULpQvlDCUMZQylDOUNJQ1lDaUN5Q4lDmUOpQ7lDyUPZQ+lD+UQJRBlEKUQ5RElEWUYZRilGOUZJRllGaUZ5RolGmUapRrlGyUbZSJlIqUi5SMlI2UjpSPlJCUkZSSlJOUlJSVlJaUl5SYlJmUmpSblJyUnZSelJ+UoJShlKKUo5SklL6Uv5TAlMGUwpTDlMSUxZTGlMeUyJTJlMqUy5RjlWSVZZVmlWeVaJVplWqVwZXClcOVxJXFlcaVx5XIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJXIlciVyJU=');

function get3(mem, i) {
    return mem[i] << 16 | mem[i + 1] << 8 | mem[i + 2];
}

function sim(mem, cycles) {
    let pc = get3(mem, 2);
    for (let i = 0; i < cycles; i++) {
        mem[get3(mem, pc + 3)] = mem[get3(mem, pc)];
        pc = get3(mem, pc + 6);
    }
}

function draw() {
    requestAnimationFrame(draw);
    let now = performance.now();
    let passed = now - old;
    console.log(passed);
    if (passed < interval) {
        return;
    }
    old = now - (passed % interval);
    sim(mem, 65536);
    let start = mem[5] << 16;
    for (let i = 0; i < canvas.width * canvas.height; i++) {
        let c = colors[mem[start + i]];
        screen.data[4 * i] = c & 255;
        screen.data[4 * i + 1] = (c >> 8) & 255;
        screen.data[4 * i + 2] = c >> 16;
        screen.data[4 * i + 3] = 255;
    }
    ctx.putImageData(screen, 0, 0);
}

let canvas = document.getElementById('screen');
let ctx = canvas.getContext('2d');
ctx.imageSmoothingEnabled = false;
canvas.width = 256;
canvas.height = 256;
canvas.style.width  = Math.min(innerWidth, innerHeight) * 0.5 + 'px';
canvas.style.height = canvas.style.width;
let screen = ctx.createImageData(canvas.width, canvas.height);
for (let i = 0; i < prog.length; i++) {
    mem[i] = prog.charCodeAt(i);
}
let interval = 1000 / 60;
let old = performance.now();
requestAnimationFrame(draw);
</script>
</body>
</html>
